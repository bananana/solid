{% extends "base.html" %}
{% set active_page = "user" %}

{% block scripts %}
{% endblock %}

{% block content %}
{% from "helpers/users.html" import render_avatar %}
<div class="full-width-container">
    <div class="row u-add-margin-top">
        <div class="three columns">
            <span>
                {{ render_avatar(user) }} 
                <strong>{{ user.nickname }}</strong> 
                {% if user.is_admin %} | <small>Admin</small>{% endif %}
            </span>
            {% if current_user == user or current_user.is_admin %}
                <a href="{{ url_for('users.edit', nickname=user.nickname) }}" class="button u-pull-right u-remove-margin-top">Edit</a>
            {% endif %}
            {% if user.full_name %}
                <h5 class="u-remove-margin-bottom">{{ user.full_name }}</h5>
            {% endif %}
            {% if current_user == user or current_user.is_admin %}
                <em>(Other users won't see these details)</em>
                {% if user.email %}<div>{{ user.email }}</div>{% endif %}
                {% if user.phone %}<div>{{ user.phone }}</div>{% endif %}
                {% if user.zip %}<div>{{ user.zip }}</div>{% endif %}
            {% endif %}
        </div>
        <div class="six columns">
            <ul>
            {% for post in feed %}
                <li><strong>{{ post.title }}</strong> by <em>{{ post.author.nickname }}</em><br>{{ post.body }}</li>
            {% else %}
                <li>
                    <em>
                        There's nothing to show here yet.<br>
                        {% if current_user == user %}
                            Start a discussion on one of the causes you're
                            supporting so that others can see it here.
                        {% else %}
                            When this user participates in a discussion, you'll
                            see it here!
                        {% endif %}
                    </em>
                </li>
            {% endfor %}
            </ul>
        </div>
        <div class="three columns">
            <h5>Created {{ user.created.count() }} causes</h5>
            <ul>
            {% for cause in user.created %}
                <li><a href="/cause/{{ cause.slug }}">{{ cause.title }}</a></li>
            {% endfor %}
            </ul>
            <hr>
            <h5>Supporting {{ user.supports.count() }} causes</h5>
            <ul>
            {% for cause in user.supports %}
                <li><a href="/cause/{{ cause.slug }}">{{ cause.title }}</a></li>
            {% endfor %}
            </ul>
            <hr>
            <h5>{{ user.actions.count() }} Support actions</h5>
            <ul>
            {% for action in user.actions %}
                <li>
                    <strong>{{ action.title }}</strong> <em>{{ action.cause.title }}</em>
                    <br>
                    {{ action.summary }}
                </li>
            {% endfor %}    
            </ul>

        </div>
    </div>

</div>
{% endblock %}
