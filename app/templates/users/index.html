{% extends "base.html" %}
{% set active_page = "user" %}

{% block title %}{{ user.nickname }} - {{ super() }}{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/modal.js') }}"></script>
{% endblock %}

{% block content %}
{% from "helpers/causes.html" import render_log with context %}
{% from "helpers/modals.html" import render_modal %}
{% from "helpers/users.html" import render_avatar %}
<div class="full-width-container">
    <div class="row u-add-margin-top">
        <div class="three columns">
            <span>
                {{ render_avatar(user) }} 
                <strong>{{ user.nickname }}</strong> 
                {% if user.is_admin %}<sup><small>{{ _('Admin') }}</small></sup>{% endif %}
            </span>
            {% if user.full_name %}
                <h5 class="u-remove-margin-bottom">{{ user.full_name }}</h5>
            {% endif %}
            {% if current_user == user or current_user.is_admin %}
                <br>
                <small class="separator u-add-margin-top">
                    <span>{{ _("Other users won't see the details below") }}</span>
                </small>
                {% if user.email %}<div>{{ user.email }}</div>{% endif %}
                {% if user.phone %}<div>{{ user.phone }}</div>{% endif %}
                {% if user.zip %}<div>{{ user.zip }}</div>{% endif %}
            {% endif %}
            {% if current_user == user or current_user.is_admin %}
                <a href="{{ url_for('users.edit', nickname=user.nickname) }}" class="button u-full-width u-add-margin-top">
                    {{ _('Edit') }}
                </a>
            {% endif %}
        </div>
        <div class="six columns">
            <ul class="no-bullets">
            {% if log %}
                {{ render_log(log.items) }} 
            {% else %}
                <small>
                    <strong>There's nothing to show here yet.</strong><br>
                    {% if current_user == user %}
                        {{ _("Start a discussion on one of the causes you're supporting so that others can see it here.") }}
                    {% else %}
                        {{ _("When this user participates in a discussion, you'll see it here!") }}
                    {% endif %}
                </small>
            {% endif %}
            </ul>
        </div>
        <div class="three columns">
            <h5>
                {% trans causes_created=user.causes_created.count() %}
                Created {{ causes_created}} cause
                {% pluralize %}
                Created {{ causes_created}} causes
                {% endtrans %}
            </h5>
            {% if user.causes_created.count() > 0 %}
                <ul class="no-bullets">
                {% for cause in user.causes_created %}
                    <li><a href="{{ url_for('causes.cause_detail', slug=cause.slug) }}">{{ cause.title }}</a></li>
                {% endfor %}
                </ul>
                <hr>
            {% endif %}
            <h5>
                {% trans causes_supports=user.causes_supports.count() %}
                Supporting {{ causes_supports }} cause
                {% pluralize %}
                Supporting {{ causes_supports }} causes
                {% endtrans %}
            </h5>
            {% if user.causes_supports.distinct().count() > 0 %}
                <ul class="no-bullets">
                {% for cause in user.causes_supports %}
                    <li><a href="{{ url_for('causes.cause_detail', slug=cause.slug) }}">{{ cause.title }}</a></li>
                {% endfor %}
                </ul>
                <hr>
            {% endif %}
            <h5>
                {% trans actions=user.actions.count() %}
                Took {{ actions }} action
                {% pluralize %}
                Took {{ actions }} actions
                {% endtrans %}
            </h5>
            {% if user.actions.count() > 0 %}
                <ul class="no-bullets">
                {% for action in user.actions %}
                    <li>
                        <a href="{{ url_for('causes.action_detail', slug=action.cause.slug, pk=action.id) }}">
                            {{ action.title }}
                        </a>
                        <small>
                            {{ _('from') }}
                            <a href="{{ url_for('causes.cause_detail', slug=action.cause.slug) }}">{{ action.cause.title }}</a>
                        </small>
                    </li>
                {% endfor %}    
                </ul>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
