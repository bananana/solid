<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="robots" content="noindex, nofollow">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    {% block meta %}
    <meta name="copyright" content="GPLv3">
    <meta name="application-name" content="Solid">

    <meta property="fb:app_id" content="{{ fb_app_id }}"/>
    {% endblock meta %}

    <title>{% block title %}Solid{% endblock %}</title>

    <link rel="icon" type="image/png" href="{{ url_for('static', filename='Skeleton/images/favicon.png') }}">
   
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/fonts.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='open-iconic/font/css/open-iconic.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='Skeleton/css/normalize.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='Skeleton/css/skeleton.css') }}">
    {% block styles %}{% endblock %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/custom.css') }}">

    <script type="text/javascript" src="{{ url_for('static', filename='js/jquery-2.1.4.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/dropdown.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/messages.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/translate.js') }}"></script>
    {{ moment.include_moment(local_js=url_for('static', filename='moment/min/moment.min.js')) }}
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.13/moment-timezone-with-data-2012-2022.min.js"></script>
    {% block scripts %}{% endblock %}

    <!-- Sentry -->
    <script src="https://cdn.ravenjs.com/3.24.0/raven.min.js" crossorigin="anonymous"></script>
    <script>Raven.config('{{ sentry_js_key }}').install();</script>
    
    <!-- Analytics -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-78265355-1', 'auto');
        {% if current_user.is_authenticated %}
        ga('set', 'userId', {{ current_user.id }});
        {% endif %}
        ga('send', 'pageview');
    </script>
</head>
<body>
    <div class="header">
        <div class="full-width-container">
            <div class="row">
                <div class="twelve columns">

                    <!-- Logo -->
                    <a href="{{ url_for('index') }}" alt="solid" title="solid">
                        <img class="title logo" src="{{ url_for('static', filename='images/solid_logo.png') }}">
                    </a>
                    
                    <!-- Login, Signup, Logout and Prifile buttons -->
                    {% if active_page == "login" %}
                        <!-- If on login page, show only signup button -->
                        <a href="{{ url_for('users.signup') }}"
                           title="{{ _('Sign up') }}"
                           class="header-button u-pull-right u-text-center">
                            <img src="{{ url_for('static', filename='open-iconic/png/task-3x.png') }}">
                            <br>
                            <small>Signup</small>
                        </a>
                    {% elif active_page == "signup" %}
                        <!-- If on signup page, show login button only -->
                        <a href="{{ url_for('users.login') }}"
                           title="{{ _('Log in') }}"
                           class="header-button u-pull-right">
                            <img src="{{ url_for('static', filename='open-iconic/png/account-login-3x.png') }}">
                            <br>
                            <small>Login</small>
                        </a>
                    {% else %}
                        {% if current_user.is_authenticated %} 
                            {% from "helpers/users.html" import render_avatar %}
                            <div id="main-menu" class="dropdown u-pull-right">
                                <div class="dropdown-button u-pull-right">
                                    {{ render_avatar(current_user) }}
                                    <span class="oi" data-glyph="caret-bottom" title="Menu" aria-hidden="true"></span>
                                </div>
                                <div class="dropdown-content">
                                    <ul>
                                        <li>
                                            {{ _('Logged&nbsp;in&nbsp;as') }}&nbsp;<strong>{{ current_user.nickname }}</strong>
                                        </li>
                                        <li class="menu-separator"></li>
                                        <li>
                                            <a href="{{ url_for('users.user', nickname=current_user.nickname) }}" title="Profile">
                                                {{ _('Your profile') }}
                                            </a>
                                        </li>
                                        <li>
                                            <a href="{{ url_for('users.edit', nickname=current_user.nickname) }}">
                                                {{ _('Settings') }}
                                            </a>
                                        </li>
                                        {% if current_user.is_admin %}
                                        <!-- Admin tools -->
                                        <li>
                                            <a href="{{ url_for('admin.admin') }}" title="Admin">
                                                {{ _('Admin') }}
                                            </a>
                                        </li>
                                        {% endif %}
                                        <li>
                                            <a href="{{ url_for('users.logout') }}">
                                                {{ _('Logout') }}
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        {% else %}
                            <!-- Otherwise show both Login and Signup buttons at the same time -->
                            <a href="{{ url_for('users.login') }}"
                               title="{{ _('Log in') }}"
                               class="header-button u-pull-right u-add-margin-left">
                                <img src="{{ url_for('static', filename='open-iconic/png/account-login-3x.png') }}">
                                <br>
                                <small>Login</small>
                            </a>
                            <a href="{{ url_for('users.signup') }}"
                               title="{{ _('Sign up') }}"
                               class="header-button u-pull-right u-text-center">
                                <img src="{{ url_for('static', filename='open-iconic/png/task-3x.png') }}">
                                <br>
                                <small>Signup</small>
                            </a>
                        {% endif %}
                    {% endif %}

                    {% if current_user.is_authenticated %} 
                        <!-- Notifications -->
                        <div id="notify-dropdown" class="dropdown u-pull-right">
                            <div class="dropdown-button u-pull-right">
                                <a href="{{ url_for('log.notifications_list_unread') }}">
                                    <img src="{{ url_for('static', filename='open-iconic/png/bell-3x.png') }}">&nbsp;
                                </a>
                            </div>
                        </div>
                    {% endif %}

                    <!-- Language picker -->
                    <div id="lang-dropdown" class="dropdown u-pull-right">
                        <div class="dropdown-button u-pull-right">
                            <span class="dropdown-lang-code">
                                {% if session['lang_code'] == 'en' %}
                                    en
                                {% elif session['lang_code'] == 'es' %}
                                    es
                                {% else %}
                                    ??
                                {% endif %}
                            </span>
                            <img src="{{ url_for('static', filename='open-iconic/png/globe-3x.png') }}">&nbsp;
                            <img style="margin-bottom:6px;" src="{{ url_for('static', filename='open-iconic/png/caret-bottom-2x.png') }}">
                        </div>
                        <div class="dropdown-content">
                            <ul>
                                {% if session['lang_code'] != 'en' %}
                                <li>
                                    <a href="javascript:translate('en')">English</a>
                                </li>
                                {% endif %}
                                {% if session['lang_code'] != 'es' %}
                                <li>
                                    <a href="javascript:translate('es');">Espa&ntilde;ol</a>
                                </li>
                                {% endif %}
                            </ul>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="content">    
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="row">
                        <div class="twelve columns">
                            <div class="flash {{ category }} u-remove-margin-bottom" role="alert">
                                {{ message }}
                                <a class="flash-close"><span class="oi" data-glyph="x"></span></a>
                            </div>
                        </div>
                   </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
    </div>

    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="three columns offset-by-three">
                    <h4>{{ _('Information') }}</h4>
                    <ul>
                        <li><a href="{{ url_for('contact') }}">{{ _('Contact') }}</a></li>
                        <li><a href="/about">{{ _('About Us') }}</a></li>
                        <li><a href="/how_it_works">{{ _('How it works') }}</a></li>
                        <li><a href="/terms_of_service">{{ _('Terms of service') }}</a></li>
                    </ul>
                </div>
                {% if debug %}
                <div class="three columns">
                    <h4>{{ _('Developers') }}</h4>
                    <ul>
                        <li><a href="{{ url_for('styleguide.styleguide') }}">{{ _('Styleguide') }}</a></li>
                        <li><a href="https://github.com/bananana/solid/">Github</a></li>
                    </ul>
                </div>
                {% endif %}
                <!--<div class="three columns">
                    <h4>Follow Us</h4>
                    <a href="#"><img class="icon-social" src="{{ url_for('static', filename='icons/twitter.png') }}"></a>
                    <a href="#"><img class="icon-social" src="{{ url_for('static', filename='icons/reddit.png') }}"></a>
                    <a href="#"><img class="icon-social" src="{{ url_for('static', filename='icons/facebook-square.png') }}"></a>
                </div>-->
            </div>
            <hr>
            <div class="row">
                <div class="twelve columns u-text-center">
                    <small>&copy; 2016-{{ now.year }} {{ site_name }} authors</small> |
                    <a href="/terms_of_service"><small>
                        {{ _('Terms of service') }}
                    </small></a>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
